<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2018-11-22 周四 01:50 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>SSM 整合示例</title>
<meta name="generator" content="Org mode">
<meta name="author" content="孙悟空">
<link rel='stylesheet' href='/asset/common.css' />
<script src='https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js'></script>
<script src='https://cdn.bootcss.com/bootstrap/3.3.4/js/bootstrap.min.js'></script>
<script src='/asset/common.js'></script>
</head>
<body>
<div id="content">
<header>
<h1 class="title">SSM 整合示例</h1>
</header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org38a48cb">1. 简介</a></li>
<li><a href="#orgcab7d94">2. 首先，创建项目</a></li>
<li><a href="#org5542e62">3. 其次，增加依赖(jar 包)</a></li>
<li><a href="#org944edb2">4. 之后，增加配置文件</a></li>
<li><a href="#org7347ee2">5. 然后就可以创建服务器，启动之了</a></li>
<li><a href="#orgfeaf8ea">6. 开始编码, 准备工作</a></li>
<li><a href="#org4c010c8">7. 开始编码, dao 层示例</a></li>
<li><a href="#orgeaa1a00">8. 开始编码, service 层示例</a></li>
<li><a href="#orga766396">9. 开始编码, web 层示例</a></li>
</ul>
</div>
</nav>


<section id="outline-container-org38a48cb" class="outline-2">
<h2 id="org38a48cb"><span class="section-number-2">1</span> 简介</h2>
<div class="outline-text-2" id="text-1">
<p>
SSM 包含三大框架:
</p>
<ul class="org-ul">
<li>Spring MVC (web level)，采取 MVC 架构，意图取代麻烦的 Servlet 写法，简化 web 层</li>
<li>MyBatis (dao level)，意图取代 jdbc 操作数据库，轻量级、灵活、高效</li>
<li>Spring，提供了 IoC(容器，用来管理组装对象) 和 AoP(切面，用来自动增强对象功能) 功能，它用来将对象和其他框架组织在一起</li>
</ul>
</div>
</section>

<section id="outline-container-orgcab7d94" class="outline-2">
<h2 id="orgcab7d94"><span class="section-number-2">2</span> 首先，创建项目</h2>
<div class="outline-text-2" id="text-2">
<p>
推荐使用 Maven 或者 Gradle 创建 ssm 项目。
</p>

<p>
可以选择在 Idea 下面，创建 Maven 或 Gradle 项目即可。
</p>
</div>
</section>

<section id="outline-container-org5542e62" class="outline-2">
<h2 id="org5542e62"><span class="section-number-2">3</span> 其次，增加依赖(jar 包)</h2>
<div class="outline-text-2" id="text-3">
<p>
Maven 的配置文件是 pom.xml，想为项目添加依赖，只需要向 pom.xml 增加相关配置即可。
</p>

<p>
这是示例:
</p>
<div class="org-src-container">
<pre class="src src-sgml"><span class="org-string">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>

&lt;<span class="org-function-name">project</span> <span class="org-variable-name">xmlns</span>=<span class="org-string">"http://maven.apache.org/POM/4.0.0"</span> <span class="org-sgml-namespace">xmlns</span>:<span class="org-variable-name">xsi</span>=<span class="org-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
  <span class="org-sgml-namespace">xsi</span>:<span class="org-variable-name">schemaLocation</span>=<span class="org-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;
  &lt;<span class="org-function-name">modelVersion</span>&gt;4.0.0&lt;/<span class="org-function-name">modelVersion</span>&gt;

  &lt;<span class="org-function-name">groupId</span>&gt;com.nf147&lt;/<span class="org-function-name">groupId</span>&gt;
  &lt;<span class="org-function-name">artifactId</span>&gt;bookstore-ssm&lt;/<span class="org-function-name">artifactId</span>&gt;
  &lt;<span class="org-function-name">version</span>&gt;0.01&lt;/<span class="org-function-name">version</span>&gt;
  &lt;<span class="org-function-name">packaging</span>&gt;war&lt;/<span class="org-function-name">packaging</span>&gt;

  &lt;<span class="org-function-name">name</span>&gt;bookstore-ssm Webapp&lt;/<span class="org-function-name">name</span>&gt;
  &lt;<span class="org-function-name">url</span>&gt;http://nf147.github.io&lt;/<span class="org-function-name">url</span>&gt;

  &lt;<span class="org-function-name">properties</span>&gt;
    &lt;<span class="org-function-name">project.build.sourceEncoding</span>&gt;UTF-8&lt;/<span class="org-function-name">project.build.sourceEncoding</span>&gt;
    &lt;<span class="org-function-name">maven.compiler.source</span>&gt;1.7&lt;/<span class="org-function-name">maven.compiler.source</span>&gt;
    &lt;<span class="org-function-name">maven.compiler.target</span>&gt;1.7&lt;/<span class="org-function-name">maven.compiler.target</span>&gt;
  &lt;/<span class="org-function-name">properties</span>&gt;

  &lt;<span class="org-function-name">dependencies</span>&gt;

    <span class="org-comment-delimiter">&lt;!--</span><span class="org-comment">spring &#25152;&#38656;&#35201;&#30340; jar &#21253;</span><span class="org-comment-delimiter">--&gt;</span>
    &lt;<span class="org-function-name">dependency</span>&gt;
      &lt;<span class="org-function-name">groupId</span>&gt;org.springframework&lt;/<span class="org-function-name">groupId</span>&gt;
      &lt;<span class="org-function-name">artifactId</span>&gt;spring-aop&lt;/<span class="org-function-name">artifactId</span>&gt;
      &lt;<span class="org-function-name">version</span>&gt;5.1.0.RELEASE&lt;/<span class="org-function-name">version</span>&gt;
    &lt;/<span class="org-function-name">dependency</span>&gt;

    &lt;<span class="org-function-name">dependency</span>&gt;
      &lt;<span class="org-function-name">groupId</span>&gt;org.aspectj&lt;/<span class="org-function-name">groupId</span>&gt;
      &lt;<span class="org-function-name">artifactId</span>&gt;aspectjweaver&lt;/<span class="org-function-name">artifactId</span>&gt;
      &lt;<span class="org-function-name">version</span>&gt;1.9.1&lt;/<span class="org-function-name">version</span>&gt;
    &lt;/<span class="org-function-name">dependency</span>&gt;

    &lt;<span class="org-function-name">dependency</span>&gt;
      &lt;<span class="org-function-name">groupId</span>&gt;org.springframework&lt;/<span class="org-function-name">groupId</span>&gt;
      &lt;<span class="org-function-name">artifactId</span>&gt;spring-jdbc&lt;/<span class="org-function-name">artifactId</span>&gt;
      &lt;<span class="org-function-name">version</span>&gt;5.1.0.RELEASE&lt;/<span class="org-function-name">version</span>&gt;
    &lt;/<span class="org-function-name">dependency</span>&gt;

    &lt;<span class="org-function-name">dependency</span>&gt;
      &lt;<span class="org-function-name">groupId</span>&gt;com.fasterxml.jackson.core&lt;/<span class="org-function-name">groupId</span>&gt;
      &lt;<span class="org-function-name">artifactId</span>&gt;jackson-databind&lt;/<span class="org-function-name">artifactId</span>&gt;
      &lt;<span class="org-function-name">version</span>&gt;2.9.7&lt;/<span class="org-function-name">version</span>&gt;
    &lt;/<span class="org-function-name">dependency</span>&gt;

    <span class="org-comment-delimiter">&lt;!--</span><span class="org-comment">spring mvc &#30340;&#20381;&#36182;</span><span class="org-comment-delimiter">--&gt;</span>
    &lt;<span class="org-function-name">dependency</span>&gt;
      &lt;<span class="org-function-name">groupId</span>&gt;org.springframework&lt;/<span class="org-function-name">groupId</span>&gt;
      &lt;<span class="org-function-name">artifactId</span>&gt;spring-web&lt;/<span class="org-function-name">artifactId</span>&gt;
      &lt;<span class="org-function-name">version</span>&gt;5.1.0.RELEASE&lt;/<span class="org-function-name">version</span>&gt;
    &lt;/<span class="org-function-name">dependency</span>&gt;
    &lt;<span class="org-function-name">dependency</span>&gt;
      &lt;<span class="org-function-name">groupId</span>&gt;org.springframework&lt;/<span class="org-function-name">groupId</span>&gt;
      &lt;<span class="org-function-name">artifactId</span>&gt;spring-webmvc&lt;/<span class="org-function-name">artifactId</span>&gt;
      &lt;<span class="org-function-name">version</span>&gt;5.1.0.RELEASE&lt;/<span class="org-function-name">version</span>&gt;
    &lt;/<span class="org-function-name">dependency</span>&gt;

    <span class="org-comment-delimiter">&lt;!--</span><span class="org-comment">mybatis jar &#21253;</span><span class="org-comment-delimiter">--&gt;</span>
    &lt;<span class="org-function-name">dependency</span>&gt;
      &lt;<span class="org-function-name">groupId</span>&gt;org.mybatis&lt;/<span class="org-function-name">groupId</span>&gt;
      &lt;<span class="org-function-name">artifactId</span>&gt;mybatis&lt;/<span class="org-function-name">artifactId</span>&gt;
      &lt;<span class="org-function-name">version</span>&gt;3.4.6&lt;/<span class="org-function-name">version</span>&gt;
    &lt;/<span class="org-function-name">dependency</span>&gt;

    &lt;<span class="org-function-name">dependency</span>&gt;
      &lt;<span class="org-function-name">groupId</span>&gt;org.mybatis&lt;/<span class="org-function-name">groupId</span>&gt;
      &lt;<span class="org-function-name">artifactId</span>&gt;mybatis-spring&lt;/<span class="org-function-name">artifactId</span>&gt;
      &lt;<span class="org-function-name">version</span>&gt;1.3.2&lt;/<span class="org-function-name">version</span>&gt;
    &lt;/<span class="org-function-name">dependency</span>&gt;

    <span class="org-comment-delimiter">&lt;!--</span><span class="org-comment">&#25968;&#25454;&#24211;&#30456;&#20851; jar &#21253;</span><span class="org-comment-delimiter">--&gt;</span>
    &lt;<span class="org-function-name">dependency</span>&gt;
      &lt;<span class="org-function-name">groupId</span>&gt;org.mariadb.jdbc&lt;/<span class="org-function-name">groupId</span>&gt;
      &lt;<span class="org-function-name">artifactId</span>&gt;mariadb-java-client&lt;/<span class="org-function-name">artifactId</span>&gt;
      &lt;<span class="org-function-name">version</span>&gt;2.3.0&lt;/<span class="org-function-name">version</span>&gt;
    &lt;/<span class="org-function-name">dependency</span>&gt;

    &lt;<span class="org-function-name">dependency</span>&gt;
      &lt;<span class="org-function-name">groupId</span>&gt;com.mchange&lt;/<span class="org-function-name">groupId</span>&gt;
      &lt;<span class="org-function-name">artifactId</span>&gt;c3p0&lt;/<span class="org-function-name">artifactId</span>&gt;
      &lt;<span class="org-function-name">version</span>&gt;0.9.5.2&lt;/<span class="org-function-name">version</span>&gt;
    &lt;/<span class="org-function-name">dependency</span>&gt;

    <span class="org-comment-delimiter">&lt;!--</span><span class="org-comment">&#20854;&#20182;</span><span class="org-comment-delimiter">--&gt;</span>
    &lt;<span class="org-function-name">dependency</span>&gt;
      &lt;<span class="org-function-name">groupId</span>&gt;javax.servlet&lt;/<span class="org-function-name">groupId</span>&gt;
      &lt;<span class="org-function-name">artifactId</span>&gt;jstl&lt;/<span class="org-function-name">artifactId</span>&gt;
      &lt;<span class="org-function-name">version</span>&gt;1.2&lt;/<span class="org-function-name">version</span>&gt;
    &lt;/<span class="org-function-name">dependency</span>&gt;

    <span class="org-comment-delimiter">&lt;!--</span><span class="org-comment">&#29992;&#26469;&#21333;&#20803;&#27979;&#35797;&#30340; jar &#21253;</span><span class="org-comment-delimiter">--&gt;</span>
    &lt;<span class="org-function-name">dependency</span>&gt;
      &lt;<span class="org-function-name">groupId</span>&gt;junit&lt;/<span class="org-function-name">groupId</span>&gt;
      &lt;<span class="org-function-name">artifactId</span>&gt;junit&lt;/<span class="org-function-name">artifactId</span>&gt;
      &lt;<span class="org-function-name">version</span>&gt;4.11&lt;/<span class="org-function-name">version</span>&gt;
      &lt;<span class="org-function-name">scope</span>&gt;test&lt;/<span class="org-function-name">scope</span>&gt;
    &lt;/<span class="org-function-name">dependency</span>&gt;
  &lt;/<span class="org-function-name">dependencies</span>&gt;

  &lt;<span class="org-function-name">build</span>&gt;
    &lt;<span class="org-function-name">finalName</span>&gt;bookstore-ssm&lt;/<span class="org-function-name">finalName</span>&gt;
  &lt;/<span class="org-function-name">build</span>&gt;
&lt;/<span class="org-function-name">project</span>&gt;
</pre>
</div>

<p>
然后，点击 Maven 工具包的刷新，jar 包就会被自动下载并配置。
</p>
</div>
</section>

<section id="outline-container-org944edb2" class="outline-2">
<h2 id="org944edb2"><span class="section-number-2">4</span> 之后，增加配置文件</h2>
<div class="outline-text-2" id="text-4">
<p>
基本只需要下面几个配置文件:
</p>
<ul class="org-ul">
<li>resources/mybatis.xml, mybatis 的核心配置文件</li>
<li>resources/spring-root.xml, spring 的核心配置文件</li>
<li>resources/spring-web.xml, spring mvc 的配置文件，可以配置 springmvc 相关的东西</li>
<li>web.xml, 因为是 web 项目，必须要配置 web.xml，让服务器启动的时候加载 spring 和 spring mvc</li>
<li>log4j.properties，用来定义日志输出</li>
</ul>

<p>
mybatis.xml:
</p>
<div class="org-src-container">
<pre class="src src-sgml"><span class="org-string">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="org-string">&lt;!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span>

&lt;<span class="org-function-name">configuration</span>&gt;
    &lt;<span class="org-function-name">settings</span>&gt;
        &lt;<span class="org-function-name">setting</span> <span class="org-variable-name">name</span>=<span class="org-string">"logImpl"</span> <span class="org-variable-name">value</span>=<span class="org-string">"LOG4J"</span>/&gt;
    &lt;/<span class="org-function-name">settings</span>&gt;
&lt;/<span class="org-function-name">configuration</span>&gt;
</pre>
</div>

<p>
spring-root.xml 示例:
</p>
<div class="org-src-container">
<pre class="src src-sgml"><span class="org-string">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
&lt;<span class="org-function-name">beans</span> <span class="org-variable-name">xmlns</span>=<span class="org-string">"http://www.springframework.org/schema/beans"</span>
       <span class="org-sgml-namespace">xmlns</span>:<span class="org-variable-name">xsi</span>=<span class="org-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="org-sgml-namespace">xmlns</span>:<span class="org-variable-name">context</span>=<span class="org-string">"http://www.springframework.org/schema/context"</span>
       <span class="org-sgml-namespace">xmlns</span>:<span class="org-variable-name">aop</span>=<span class="org-string">"http://www.springframework.org/schema/aop"</span>
       <span class="org-sgml-namespace">xmlns</span>:<span class="org-variable-name">tx</span>=<span class="org-string">"http://www.springframework.org/schema/tx"</span>
       <span class="org-sgml-namespace">xsi</span>:<span class="org-variable-name">schemaLocation</span>=<span class="org-string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd"</span>&gt;

    <span class="org-comment-delimiter">&lt;!--</span><span class="org-comment">@Component/@Service/@Repository/@Controller</span><span class="org-comment-delimiter">--&gt;</span>
    &lt;<span class="org-sgml-namespace">context</span>:<span class="org-function-name">component-scan</span> <span class="org-variable-name">base-package</span>=<span class="org-string">"com.nf147.bookstore_ssm.service"</span> /&gt;

    <span class="org-comment-delimiter">&lt;!--</span><span class="org-comment">&#21019;&#24314;&#25968;&#25454;&#28304;</span><span class="org-comment-delimiter">--&gt;</span>
    &lt;<span class="org-function-name">bean</span> <span class="org-variable-name">id</span>=<span class="org-string">"dataSource"</span> <span class="org-variable-name">class</span>=<span class="org-string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;
        &lt;<span class="org-function-name">property</span> <span class="org-variable-name">name</span>=<span class="org-string">"driverClass"</span> <span class="org-variable-name">value</span>=<span class="org-string">"org.mariadb.jdbc.Driver"</span> /&gt;
        &lt;<span class="org-function-name">property</span> <span class="org-variable-name">name</span>=<span class="org-string">"jdbcUrl"</span> <span class="org-variable-name">value</span>=<span class="org-string">"jdbc:mariadb://localhost:3306/lagou"</span> /&gt;
        &lt;<span class="org-function-name">property</span> <span class="org-variable-name">name</span>=<span class="org-string">"user"</span> <span class="org-variable-name">value</span>=<span class="org-string">"vip"</span> /&gt;
        &lt;<span class="org-function-name">property</span> <span class="org-variable-name">name</span>=<span class="org-string">"password"</span> <span class="org-variable-name">value</span>=<span class="org-string">"vip"</span> /&gt;
    &lt;/<span class="org-function-name">bean</span>&gt;

    <span class="org-comment-delimiter">&lt;!--</span><span class="org-comment">&#37197;&#32622; mybatis</span><span class="org-comment-delimiter">--&gt;</span>
    &lt;<span class="org-function-name">bean</span> <span class="org-variable-name">id</span>=<span class="org-string">"sqlSessionFactory"</span> <span class="org-variable-name">class</span>=<span class="org-string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;
        &lt;<span class="org-function-name">property</span> <span class="org-variable-name">name</span>=<span class="org-string">"dataSource"</span> <span class="org-variable-name">ref</span>=<span class="org-string">"dataSource"</span> /&gt;
        &lt;<span class="org-function-name">property</span> <span class="org-variable-name">name</span>=<span class="org-string">"configLocation"</span> <span class="org-variable-name">value</span>=<span class="org-string">"classpath:mybatis.xml"</span> /&gt;
        &lt;<span class="org-function-name">property</span> <span class="org-variable-name">name</span>=<span class="org-string">"mapperLocations"</span> <span class="org-variable-name">value</span>=<span class="org-string">"classpath:mapper/*.xml"</span> /&gt;
    &lt;/<span class="org-function-name">bean</span>&gt;

    &lt;<span class="org-function-name">bean</span> <span class="org-variable-name">class</span>=<span class="org-string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;
        &lt;<span class="org-function-name">property</span> <span class="org-variable-name">name</span>=<span class="org-string">"sqlSessionFactoryBeanName"</span> <span class="org-variable-name">value</span>=<span class="org-string">"sqlSessionFactory"</span> /&gt;
        &lt;<span class="org-function-name">property</span> <span class="org-variable-name">name</span>=<span class="org-string">"basePackage"</span> <span class="org-variable-name">value</span>=<span class="org-string">"com.nf147.bookstore_ssm.dao"</span> /&gt;
    &lt;/<span class="org-function-name">bean</span>&gt;

    <span class="org-comment-delimiter">&lt;!--</span><span class="org-comment">&#37197;&#32622;&#20107;&#21153;&#31649;&#29702;</span><span class="org-comment-delimiter">--&gt;</span>
    &lt;<span class="org-function-name">bean</span> <span class="org-variable-name">id</span>=<span class="org-string">"transactionManager"</span> <span class="org-variable-name">class</span>=<span class="org-string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;
        &lt;<span class="org-function-name">property</span> <span class="org-variable-name">name</span>=<span class="org-string">"dataSource"</span> <span class="org-variable-name">ref</span>=<span class="org-string">"dataSource"</span> /&gt;
    &lt;/<span class="org-function-name">bean</span>&gt;
    &lt;<span class="org-sgml-namespace">tx</span>:<span class="org-function-name">annotation-driven</span> <span class="org-variable-name">proxy-target-class</span>=<span class="org-string">"true"</span> /&gt;

    <span class="org-comment-delimiter">&lt;!-- </span><span class="org-comment">AspectJ </span><span class="org-comment-delimiter">--&gt;</span>
    &lt;<span class="org-sgml-namespace">aop</span>:<span class="org-function-name">aspectj-autoproxy</span> <span class="org-variable-name">proxy-target-class</span>=<span class="org-string">"true"</span> /&gt;
&lt;/<span class="org-function-name">beans</span>&gt;
</pre>
</div>

<p>
spring-web.xml 示例:
</p>
<div class="org-src-container">
<pre class="src src-sgml"><span class="org-string">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
&lt;<span class="org-function-name">beans</span> <span class="org-variable-name">xmlns</span>=<span class="org-string">"http://www.springframework.org/schema/beans"</span>
       <span class="org-sgml-namespace">xmlns</span>:<span class="org-variable-name">xsi</span>=<span class="org-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="org-sgml-namespace">xmlns</span>:<span class="org-variable-name">context</span>=<span class="org-string">"http://www.springframework.org/schema/context"</span>
       <span class="org-sgml-namespace">xmlns</span>:<span class="org-variable-name">mvc</span>=<span class="org-string">"http://www.springframework.org/schema/mvc"</span>
       <span class="org-sgml-namespace">xsi</span>:<span class="org-variable-name">schemaLocation</span>=<span class="org-string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/cache http://www.springframework.org/schema/cache/spring-cache.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;

    <span class="org-comment-delimiter">&lt;!--</span><span class="org-comment">&#25195;&#25551;&#21253;&#19979;&#38754;&#25152;&#26377;&#30340; @Controller &#27880;&#35299;&#30340;&#31867;&#65292;&#24182;&#23558;&#20854;&#23454;&#20363;&#21270;&#65292;&#25918;&#20837;&#23481;&#22120;</span><span class="org-comment-delimiter">--&gt;</span>
    &lt;<span class="org-sgml-namespace">context</span>:<span class="org-function-name">component-scan</span> <span class="org-variable-name">base-package</span>=<span class="org-string">"com.nf147.bookstore_ssm.web"</span> /&gt;

    <span class="org-comment-delimiter">&lt;!--</span><span class="org-comment">&#21551;&#29992; mvc &#30340;&#24120;&#29992;&#27880;&#35299;</span><span class="org-comment-delimiter">--&gt;</span>
    &lt;<span class="org-sgml-namespace">mvc</span>:<span class="org-function-name">annotation-driven</span> /&gt;

    <span class="org-comment-delimiter">&lt;!--</span><span class="org-comment">&#23558;&#25152;&#26377;&#30340;&#38745;&#24577;&#36164;&#28304;&#65292;&#20132;&#32473; Servlet &#22788;&#29702;</span><span class="org-comment-delimiter">--&gt;</span>
    &lt;<span class="org-sgml-namespace">mvc</span>:<span class="org-function-name">default-servlet-handler</span> /&gt;

    <span class="org-comment-delimiter">&lt;!--</span><span class="org-comment">&#37197;&#32622;&#35270;&#22270;&#35299;&#26512;&#22120;&#65292;&#20351;&#29992; jsp &#26469;&#28210;&#26579;&#35270;&#22270;</span><span class="org-comment-delimiter">--&gt;</span>
    &lt;<span class="org-function-name">bean</span> <span class="org-variable-name">class</span>=<span class="org-string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;
        &lt;<span class="org-function-name">property</span> <span class="org-variable-name">name</span>=<span class="org-string">"viewClass"</span> <span class="org-variable-name">value</span>=<span class="org-string">"org.springframework.web.servlet.view.JstlView"</span> /&gt;
        &lt;<span class="org-function-name">property</span> <span class="org-variable-name">name</span>=<span class="org-string">"prefix"</span> <span class="org-variable-name">value</span>=<span class="org-string">"/WEB-INF/views/"</span> /&gt;
        &lt;<span class="org-function-name">property</span> <span class="org-variable-name">name</span>=<span class="org-string">"suffix"</span> <span class="org-variable-name">value</span>=<span class="org-string">".jsp"</span> /&gt;
    &lt;/<span class="org-function-name">bean</span>&gt;
&lt;/<span class="org-function-name">beans</span>&gt;
</pre>
</div>

<p>
web.xml 示例，用来驱动 spring 和 spring mvc:
</p>
<div class="org-src-container">
<pre class="src src-sgml"><span class="org-string">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
&lt;<span class="org-function-name">web-app</span> <span class="org-variable-name">xmlns</span>=<span class="org-string">"http://xmlns.jcp.org/xml/ns/javaee"</span>
         <span class="org-sgml-namespace">xmlns</span>:<span class="org-variable-name">xsi</span>=<span class="org-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="org-sgml-namespace">xsi</span>:<span class="org-variable-name">schemaLocation</span>=<span class="org-string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"</span>
         <span class="org-variable-name">version</span>=<span class="org-string">"4.0"</span>&gt;

    &lt;<span class="org-function-name">display-name</span>&gt;ssm demo&lt;/<span class="org-function-name">display-name</span>&gt;

    <span class="org-comment-delimiter">&lt;!--</span><span class="org-comment">&#37197;&#32622; Spring &#30340;&#23481;&#22120;</span><span class="org-comment-delimiter">--&gt;</span>
    &lt;<span class="org-function-name">context-param</span>&gt;
        &lt;<span class="org-function-name">param-name</span>&gt;contextConfigLocation&lt;/<span class="org-function-name">param-name</span>&gt;
        &lt;<span class="org-function-name">param-value</span>&gt;classpath:spring-root.xml&lt;/<span class="org-function-name">param-value</span>&gt;
    &lt;/<span class="org-function-name">context-param</span>&gt;
    &lt;<span class="org-function-name">listener</span>&gt;
        &lt;<span class="org-function-name">listener-class</span>&gt;org.springframework.web.context.ContextLoaderListener&lt;/<span class="org-function-name">listener-class</span>&gt;
    &lt;/<span class="org-function-name">listener</span>&gt;

    <span class="org-comment-delimiter">&lt;!--</span><span class="org-comment">&#37197;&#32622; MVC &#23481;&#22120;</span><span class="org-comment-delimiter">--&gt;</span>
    <span class="org-comment-delimiter">&lt;!--</span><span class="org-comment">&#23558;&#25152;&#26377;&#30340;&#35831;&#27714;&#65292;&#37117;&#20132;&#32473; Spring MVC &#22788;&#29702;</span><span class="org-comment-delimiter">--&gt;</span>
    &lt;<span class="org-function-name">servlet</span>&gt;
        &lt;<span class="org-function-name">servlet-name</span>&gt;app&lt;/<span class="org-function-name">servlet-name</span>&gt;
        &lt;<span class="org-function-name">servlet-class</span>&gt;org.springframework.web.servlet.DispatcherServlet&lt;/<span class="org-function-name">servlet-class</span>&gt;
        &lt;<span class="org-function-name">init-param</span>&gt;
            &lt;<span class="org-function-name">param-name</span>&gt;contextConfigLocation&lt;/<span class="org-function-name">param-name</span>&gt;
            &lt;<span class="org-function-name">param-value</span>&gt;classpath:spring-web.xml&lt;/<span class="org-function-name">param-value</span>&gt;
        &lt;/<span class="org-function-name">init-param</span>&gt;
    &lt;/<span class="org-function-name">servlet</span>&gt;
    &lt;<span class="org-function-name">servlet-mapping</span>&gt;
        &lt;<span class="org-function-name">servlet-name</span>&gt;app&lt;/<span class="org-function-name">servlet-name</span>&gt;
        &lt;<span class="org-function-name">url-pattern</span>&gt;/&lt;/<span class="org-function-name">url-pattern</span>&gt;
    &lt;/<span class="org-function-name">servlet-mapping</span>&gt;
&lt;/<span class="org-function-name">web-app</span>&gt;
</pre>
</div>

<p>
log4j.properties，用来配置日志:
</p>
<div class="org-src-container">
<pre class="src src-conf"># &#20840;&#23616;&#37197;&#32622;: &#21482;&#26174;&#31034;&#38169;&#35823;&#32423;&#21035;&#30340;&#26085;&#24535;&#65292;&#36755;&#20986;&#20026;&#21517;&#23383;&#20026; stdou &#30340;&#26085;&#24535;
<span class="org-variable-name">log4j.rootLogger</span>=ERROR, stdout

# MyBatis &#30340;&#26085;&#24535;&#37197;&#32622;&#65292;&#21482;&#36755;&#20986; com.nf147.bookstore_ssm.dao &#21253;&#19979;&#20135;&#29983; INFO &#20197;&#21450;&#20197;&#19978;&#32423;&#21035;&#30340;&#26085;&#24535;
<span class="org-variable-name">log4j.logger.com.nf147.bookstore_ssm.dao</span>=INFO

# &#23450;&#20041;&#21517;&#23383;&#20026; stdout &#30340;&#26085;&#24535;&#65292;&#23558;&#26085;&#24535;&#36755;&#20986;&#21040;&#25511;&#21046;&#21488;
<span class="org-variable-name">log4j.appender.stdout</span>=org.apache.log4j.ConsoleAppender
<span class="org-variable-name">log4j.appender.stdout.layout</span>=org.apache.log4j.PatternLayout
<span class="org-variable-name">log4j.appender.stdout.layout.ConversionPattern</span>=%5p [%t] - %m%n
</pre>
</div>

<p>
然后，创建相关的目录结构，如图:
</p>



<figure>
<img src="img/clip_2018-09-27_01-24-07.png" alt="clip_2018-09-27_01-24-07.png">

</figure>
</div>
</section>

<section id="outline-container-org7347ee2" class="outline-2">
<h2 id="org7347ee2"><span class="section-number-2">5</span> 然后就可以创建服务器，启动之了</h2>
<div class="outline-text-2" id="text-5">
<p>
之后就可以在 idea 里面创建应用服务器，将项目部署到上面，运行之。
</p>
</div>
</section>

<section id="outline-container-orgfeaf8ea" class="outline-2">
<h2 id="orgfeaf8ea"><span class="section-number-2">6</span> 开始编码, 准备工作</h2>
<div class="outline-text-2" id="text-6">
<p>
创建表:
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">create</span> <span class="org-keyword">table</span> <span class="org-function-name">ssm_book</span> (
    bookid <span class="org-type">int</span> auto_increment <span class="org-keyword">primary</span> <span class="org-keyword">key</span>,
    <span class="org-keyword">name</span> <span class="org-type">varchar</span>(20) <span class="org-keyword">not</span> <span class="org-keyword">null</span>,
    cnt <span class="org-type">int</span> <span class="org-keyword">default</span> 0
);
</pre>
</div>

<p>
为其创建实现类:
</p>
<div class="org-src-container">
<pre class="src src-java"><span class="org-keyword">package</span> com.nf147.bookstore_ssm.<span class="org-constant">entity</span>;

<span class="org-keyword">public</span> <span class="org-keyword">class</span> <span class="org-type">Book</span> {
    <span class="org-keyword">private</span> <span class="org-type">int</span> <span class="org-variable-name">bookid</span>;
    <span class="org-keyword">private</span> <span class="org-type">String</span> <span class="org-variable-name">name</span>;
    <span class="org-keyword">private</span> <span class="org-type">int</span> <span class="org-variable-name">cnt</span>;

    <span class="org-keyword">public</span> <span class="org-function-name">Book</span>() {
    }

    <span class="org-keyword">public</span> <span class="org-function-name">Book</span>(<span class="org-type">String</span> <span class="org-variable-name">name</span>, <span class="org-type">int</span> <span class="org-variable-name">cnt</span>) {
        <span class="org-keyword">this</span>.name = name;
        <span class="org-keyword">this</span>.cnt = cnt;
    }

    <span class="org-keyword">public</span> <span class="org-type">int</span> <span class="org-function-name">getBookid</span>() {
        <span class="org-keyword">return</span> bookid;
    }

    <span class="org-keyword">public</span> <span class="org-type">void</span> <span class="org-function-name">setBookid</span>(<span class="org-type">int</span> <span class="org-variable-name">bookid</span>) {
        <span class="org-keyword">this</span>.bookid = bookid;
    }

    <span class="org-keyword">public</span> <span class="org-type">String</span> <span class="org-function-name">getName</span>() {
        <span class="org-keyword">return</span> name;
    }

    <span class="org-keyword">public</span> <span class="org-type">void</span> <span class="org-function-name">setName</span>(<span class="org-type">String</span> <span class="org-variable-name">name</span>) {
        <span class="org-keyword">this</span>.name = name;
    }

    <span class="org-keyword">public</span> <span class="org-type">int</span> <span class="org-function-name">getCnt</span>() {
        <span class="org-keyword">return</span> cnt;
    }

    <span class="org-keyword">public</span> <span class="org-type">void</span> <span class="org-function-name">setCnt</span>(<span class="org-type">int</span> <span class="org-variable-name">cnt</span>) {
        <span class="org-keyword">this</span>.cnt = cnt;
    }

    <span class="org-c-annotation">@Override</span>
    <span class="org-keyword">public</span> <span class="org-type">String</span> <span class="org-function-name">toString</span>() {
        <span class="org-keyword">return</span> <span class="org-string">"Book{"</span> +
                <span class="org-string">"bookid="</span> + bookid +
                <span class="org-string">", name='"</span> + name + <span class="org-string">'\''</span> +
                <span class="org-string">", cnt="</span> + cnt +
                <span class="org-string">'}'</span>;
    }
}
</pre>
</div>
</div>
</section>

<section id="outline-container-org4c010c8" class="outline-2">
<h2 id="org4c010c8"><span class="section-number-2">7</span> 开始编码, dao 层示例</h2>
<div class="outline-text-2" id="text-7">
<p>
其创建 BookDAO 接口，实现数据库查询与操作:
</p>
<div class="org-src-container">
<pre class="src src-java"><span class="org-keyword">public</span> <span class="org-keyword">interface</span> <span class="org-type">BookDAO</span> {
    <span class="org-doc">/**</span>
<span class="org-doc">     * &#36890;&#36807; id &#33719;&#21462;&#22270;&#20070;</span>
<span class="org-doc">     */</span>
    <span class="org-type">Book</span> <span class="org-function-name">getById</span>(<span class="org-type">int</span> <span class="org-variable-name">bookid</span>);

    <span class="org-doc">/**</span>
<span class="org-doc">     * &#33719;&#21462;&#20070;&#31821;&#25968;&#30446;</span>
<span class="org-doc">     */</span>
    <span class="org-type">int</span> <span class="org-function-name">countAll</span>();

    <span class="org-doc">/**</span>
<span class="org-doc">     * &#33719;&#21462;&#25152;&#26377;&#22270;&#20070;</span>
<span class="org-doc">     */</span>
    <span class="org-type">List</span>&lt;<span class="org-type">Book</span>&gt; <span class="org-function-name">listAll</span>();

    <span class="org-doc">/**</span>
<span class="org-doc">     * &#33719;&#21462;&#25152;&#26377;&#22270;&#20070;</span>
<span class="org-doc">     */</span>
    <span class="org-type">List</span>&lt;<span class="org-type">Book</span>&gt; <span class="org-function-name">listAllPager</span>(<span class="org-c-annotation">@Param</span>(<span class="org-string">"offset"</span>) <span class="org-type">int</span> <span class="org-variable-name">offset</span>, <span class="org-c-annotation">@Param</span>(<span class="org-string">"size"</span>) <span class="org-type">int</span> <span class="org-variable-name">size</span>);

    <span class="org-doc">/**</span>
<span class="org-doc">     * &#26032;&#22686;&#22270;&#20070;</span>
<span class="org-doc">     */</span>
    <span class="org-type">int</span> <span class="org-function-name">insert</span>(<span class="org-type">Book</span> <span class="org-variable-name">book</span>);

    <span class="org-doc">/**</span>
<span class="org-doc">     * &#20462;&#25913;&#22270;&#20070;</span>
<span class="org-doc">     */</span>
    <span class="org-type">int</span> <span class="org-function-name">update</span>(<span class="org-type">Book</span> <span class="org-variable-name">book</span>);

    <span class="org-doc">/**</span>
<span class="org-doc">     * &#21024;&#38500;&#22270;&#20070;</span>
<span class="org-doc">     */</span>
    <span class="org-type">int</span> <span class="org-function-name">delete</span>(<span class="org-type">int</span> <span class="org-variable-name">bookid</span>);
}
</pre>
</div>

<p>
然后，为这个接口，编写相应 mapper.xml，可以看做这个 xml 是这个接口的实现类(由 mybatis 根据这个 xml 创建相应的实现类):
</p>

<div class="org-src-container">
<pre class="src src-sgml"><span class="org-string">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="org-string">&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span>

&lt;<span class="org-function-name">mapper</span> <span class="org-variable-name">namespace</span>=<span class="org-string">"com.nf147.bookstore_ssm.dao.BookDAO"</span>&gt;
    &lt;<span class="org-function-name">insert</span> <span class="org-variable-name">id</span>=<span class="org-string">"insert"</span> <span class="org-variable-name">parameterType</span>=<span class="org-string">"com.nf147.bookstore_ssm.entity.Book"</span>&gt;
        insert into ssm_book (name, cnt) values (#{name}, #{cnt})
    &lt;/<span class="org-function-name">insert</span>&gt;

    &lt;<span class="org-function-name">insert</span> <span class="org-variable-name">id</span>=<span class="org-string">"update"</span> <span class="org-variable-name">parameterType</span>=<span class="org-string">"com.nf147.bookstore_ssm.entity.Book"</span>&gt;
        update ssm_book
          set name = #{name}, cnt = #{cnt}
          where bookid = #{bookid}
    &lt;/<span class="org-function-name">insert</span>&gt;

    &lt;<span class="org-function-name">delete</span> <span class="org-variable-name">id</span>=<span class="org-string">"delete"</span> <span class="org-variable-name">parameterType</span>=<span class="org-string">"int"</span>&gt;
        delete from ssm_book where bookid=#{bookid}
    &lt;/<span class="org-function-name">delete</span>&gt;

    &lt;<span class="org-function-name">select</span> <span class="org-variable-name">id</span>=<span class="org-string">"getById"</span> <span class="org-variable-name">parameterType</span>=<span class="org-string">"int"</span> <span class="org-variable-name">resultType</span>=<span class="org-string">"com.nf147.bookstore_ssm.entity.Book"</span>&gt;
            select bookid, name, cnt from ssm_book where bookid = #{bookid}
    &lt;/<span class="org-function-name">select</span>&gt;

    &lt;<span class="org-function-name">select</span> <span class="org-variable-name">id</span>=<span class="org-string">"countAll"</span> <span class="org-variable-name">resultType</span>=<span class="org-string">"java.lang.Integer"</span>&gt;
        select count(*) from ssm_book
    &lt;/<span class="org-function-name">select</span>&gt;

    &lt;<span class="org-function-name">select</span> <span class="org-variable-name">id</span>=<span class="org-string">"listAll"</span> <span class="org-variable-name">resultType</span>=<span class="org-string">"com.nf147.bookstore_ssm.entity.Book"</span>&gt;
        select bookid, name, cnt from ssm_book
    &lt;/<span class="org-function-name">select</span>&gt;

    &lt;<span class="org-function-name">select</span> <span class="org-variable-name">id</span>=<span class="org-string">"listAllPager"</span> <span class="org-variable-name">resultType</span>=<span class="org-string">"com.nf147.bookstore_ssm.entity.Book"</span>&gt;
        select bookid, name, cnt from ssm_book limit #{offset}, #{size}
    &lt;/<span class="org-function-name">select</span>&gt;
&lt;/<span class="org-function-name">mapper</span>&gt;
</pre>
</div>
</div>
</section>

<section id="outline-container-orgeaa1a00" class="outline-2">
<h2 id="orgeaa1a00"><span class="section-number-2">8</span> 开始编码, service 层示例</h2>
<div class="outline-text-2" id="text-8">
<p>
需要有接口，有实现类，面向接口编程。
</p>

<p>
需要在实现类上，写 <code>@Service</code> 注解。
</p>

<p>
根据实际需要，在需要开启事务的方法上，添加 <code>@Transactional</code> 注解。
</p>
</div>
</section>

<section id="outline-container-orga766396" class="outline-2">
<h2 id="orga766396"><span class="section-number-2">9</span> 开始编码, web 层示例</h2>
<div class="outline-text-2" id="text-9">
<p>
简单示例:
</p>
<div class="org-src-container">
<pre class="src src-java"><span class="org-c-annotation">@Controller</span>
<span class="org-keyword">public</span> <span class="org-keyword">class</span> <span class="org-type">BookController</span> {

    <span class="org-c-annotation">@Autowired</span>
    <span class="org-keyword">private</span> <span class="org-type">BookService</span> <span class="org-variable-name">bookService</span>;

    <span class="org-c-annotation">@RequestMapping</span>(<span class="org-string">"/book"</span>)
    <span class="org-keyword">public</span> <span class="org-type">ModelAndView</span> <span class="org-function-name">getBook</span>(<span class="org-type">int</span> <span class="org-variable-name">bookid</span>) {
        <span class="org-type">ModelAndView</span> <span class="org-variable-name">mv</span> = <span class="org-keyword">new</span> <span class="org-type">ModelAndView</span>(<span class="org-string">"book_detail"</span>);
        <span class="org-type">Book</span> <span class="org-variable-name">book</span> = bookService.getBookById(bookid);
        mv.addObject(<span class="org-string">"book"</span>, book);
        <span class="org-keyword">return</span> mv;
    }

    <span class="org-c-annotation">@RequestMapping</span>(<span class="org-string">"/bookupdate"</span>)
    <span class="org-keyword">public</span> <span class="org-type">String</span> <span class="org-function-name">update</span>(<span class="org-type">int</span> <span class="org-variable-name">bookid</span>) {
        <span class="org-keyword">for</span> (<span class="org-type">int</span> <span class="org-variable-name">i</span> = 0; i &lt; 10000; i++) {
            bookService.updateCnt(bookid);
        }
        <span class="org-keyword">return</span> <span class="org-string">"book_detail"</span>;
    }
}
</pre>
</div>
</div>
</section>
</div>
<div id="postamble" class="status">
<p class="author">Author: 孙悟空</p>
<p class="date">Created: 2018-11-22 周四 01:50</p>
<p class="validation">Go ahead, never stop.</p>
</div>
</body>
</html>
