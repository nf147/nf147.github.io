<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2018-10-30 Tue 13:38 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Form/Ajax</title>
<meta name="generator" content="Org mode">
<meta name="author" content="孙悟空">
<link rel='stylesheet' href='/asset/common.css' />
<script src='https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js'></script>
<script src='https://cdn.bootcss.com/bootstrap/3.3.4/js/bootstrap.min.js'></script>
<script src='/asset/common.js'></script>
</head>
<body>
<div id="content">
<header>
<h1 class="title">Form/Ajax</h1>
</header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org83efdd3">1. XMLHttpRequest</a></li>
<li><a href="#org216f560">2. Fetch API</a></li>
</ul>
</div>
</nav>




<section id="outline-container-org83efdd3" class="outline-2">
<h2 id="org83efdd3"><span class="section-number-2">1</span> XMLHttpRequest</h2>
<div class="outline-text-2" id="text-1">
<p>
也算比较简单，需要掌握。不要没有 jQuery 就写不出代码，那样很危险。。
</p>

<div class="org-src-container">
<pre class="src src-js"><span class="org-comment-delimiter">// </span><span class="org-comment">&#21021;&#22987;&#21270;</span>
<span class="org-keyword">let</span> <span class="org-variable-name">xhr</span> = <span class="org-keyword">new</span> <span class="org-type">XMLHttpRequest</span>();

<span class="org-comment-delimiter">// </span><span class="org-comment">&#21487;&#20197;&#22686;&#21152;&#35831;&#27714;&#21442;&#25968;</span>
xhr.timeout = 3000;
xhr.reponseType = <span class="org-string">"text"</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">&#25171;&#24320;&#19968;&#37096;&#35831;&#27714;</span>
xhr.open(<span class="org-string">'POST'</span>, <span class="org-string">'/url'</span>, <span class="org-constant">true</span>);

<span class="org-comment-delimiter">// </span><span class="org-comment">&#21457;&#36865;&#35831;&#27714;&#65292;&#20801;&#35768;&#25658;&#24102;&#35831;&#27714;&#21442;&#25968;</span>
xhr.send(<span class="org-constant">null</span>);

<span class="org-comment-delimiter">// </span><span class="org-comment">&#20026;&#35831;&#27714;&#27880;&#20876;&#22238;&#35843;&#20989;&#25968;</span>
xhr.ontimeout = {...}
xhr.error = {...}
xhr.onprogress = {...}
xhr.upload.onprogress = {...}
xhr.onload = <span class="org-keyword">function</span> (<span class="org-variable-name">e</span>) {
    <span class="org-keyword">if</span>(<span class="org-constant">this</span>.status == 200) {
        alert(<span class="org-constant">this</span>.responseText);
    } <span class="org-keyword">else</span> {
        alert(<span class="org-constant">this</span>.statusText);
    }
};
</pre>
</div>
</div>
</section>

<section id="outline-container-org216f560" class="outline-2">
<h2 id="org216f560"><span class="section-number-2">2</span> Fetch API</h2>
<div class="outline-text-2" id="text-2">
<p>
旨在取代 XHR 的新标准，目前不是很成熟，但是日常测试使用很方便。
</p>

<p>
三个接口一个方法: <code>Headers/Request/Response</code>, <code>fetch()</code>，语法简洁。
</p>

<div class="org-src-container">
<pre class="src src-js">fetch(<span class="org-string">'/some.json'</span>, {
    method: <span class="org-string">'get'</span>,
    body: { id: 22 }
}).then(<span class="org-keyword">function</span> (<span class="org-variable-name">resp</span>) {
    resp.json().then(console.log);

}).<span class="org-keyword">catch</span>(<span class="org-keyword">function</span> (<span class="org-variable-name">r</span>) {
    console.err(r);
});
</pre>
</div>
</div>
</section>
</div>
<div id="postamble" class="status">
<p class="author">Author: 孙悟空</p>
<p class="date">Created: 2018-10-30 Tue 13:38</p>
<p class="validation">Go ahead, never stop.</p>
</div>
</body>
</html>
